<!DOCTYPE html>




































<html class="hasSidebar hasPageActions hasBreadcrumb conceptual has-default-focus" lang="en-us" dir="ltr" data-css-variable-support="true" data-authenticated="false" data-auth-status-determined="false" data-target="docs" x-ms-format-detection="none">

<head>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<meta property="og:title" content="XInput and DirectInput - Windows applications" />
	<meta property="og:type" content="website" />
	<meta property="og:url" content="https://docs.microsoft.com/en-us/windows/win32/xinput/xinput-and-directinput" />
		<meta property="og:description" content="XInput is an API that allows applications to receive input from the Xbox 360 Controller for Windows." />
		<meta property="og:image" content="https://docs.microsoft.com/en-us/media/logos/logo-ms-social.png" />
		<meta property="og:image:alt" content="Microsoft Logo" />

	<meta name="twitter:card" content="summary" />
	<meta name="twitter:site" content="@docsmsft" />

		<meta name="author" content="Karl-Bridge-Microsoft" />
<meta name="ms.author" content="kbridge" />
<meta name="breadcrumb_path" content="/windows/desktop/breadcrumb/toc.json" />
<meta name="ms.prod" content="desktop" />
<meta name="uhfHeaderId" content="MSDocsHeader-WinDesktop" />
<meta name="ms.assetid" content="0f29a47b-24ed-c0fa-e9e9-8a061619845c" />
<meta name="description" content="XInput is an API that allows applications to receive input from the Xbox 360 Controller for Windows." />
<meta name="ms.topic" content="article" />
<meta name="ms.date" content="05/31/2018" />
<meta name="search.ms_sitename" content="Docs" />
<meta name="search.ms_docsetname" content="win32" />
<meta name="locale" content="en-us" />
<meta name="site_name" content="Docs" />
<meta name="search.ms_product" content="MSDN" />
<meta name="depot_name" content="MSDN.win32" />
<meta name="updated_at" content="2019-03-14 08:45 PM" />
<meta name="gitcommit" content="https://github.com/MicrosoftDocs/win32-pr/blob/0180b6dbcaa133e58745702bf0ebefa871ee151b/desktop-src/xinput/xinput-and-directinput.md" />
<meta name="original_content_git_url" content="https://github.com/MicrosoftDocs/win32-pr/blob/live/desktop-src/xinput/xinput-and-directinput.md" />
<meta name="document_id" content="99ef4695-07f1-f9f7-f6e9-5eaaf4e5d9a3" />
<meta name="document_version_independent_id" content="fd3e252f-079f-7ebd-562b-195b1a0efb88" />
<meta name="page_type" content="conceptual" />
<meta name="toc_rel" content="toc.json" />
<meta name="word_count" content="967" />

	<meta name="scope" content="Windows, Desktop" />
<link href="https://docs.microsoft.com/en-us/windows/win32/xinput/xinput-and-directinput" rel="canonical">
	<title>XInput and DirectInput - Windows applications | Microsoft Docs</title>

		<link rel="stylesheet" href="/_themes/docs.theme/master/en-us/_themes/styles/adec96e7.site-ltr.css ">

	<link rel="stylesheet" href="/_themes/docs.theme/master/en-us/_themes/styles/cd54db8b.conceptual.css ">


	<script>
	var msDocs = {
		data: {
			timeOrigin: Date.now(),
			azureHeaderLocale: 'en-us',
			contentLocale: 'en-us',
			contentDir: 'ltr',
			userLocale: 'en-us',
			userDir: 'ltr',
			pageTemplate: 'Conceptual',
			brand: '',
			context: {

			},
			hasComments: false,
			feedbackSystem: 'None',
			feedbackGitHubRepo: '',
			feedbackProductUrl: '',
			contentGitUrl: 'https://github.com/MicrosoftDocs/win32-pr/blob/live/desktop-src/xinput/xinput-and-directinput.md',
		},
		functions:{},
		settings:{
			extendBreadcrumb: true,
			enableUHFPPE: false
		}
	};
	if (!('Promise' in window && 'resolve' in window.Promise && 'reject' in window.Promise && 'all' in window.Promise && 'race' in window.Promise)) {
		document.write('<script src="https://static.docs.com/ui/third-party/bluebird/3.5.0/bluebird.min.js" integrity="sha384-aD4BDeDGeLXLpPK4yKeqtZQa9dv4a/7mQ+4L5vwshIYH1Mc2BrXvHd32iHzYCQy5" crossorigin="anonymous"><\/script>');
	}
	if (typeof fetch !== 'function') {
		document.write('<script src="https://static.docs.com/ui/third-party/fetch/2.0.3/fetch.min.js" integrity="sha384-H3LQq82b6Mm80GYRHtRSlTwO9DoXctmYCVEYk9M8mp97lRzs6DuSrHVUg3SBP9w0" crossorigin="anonymous"><\/script>');
	}
	if (typeof HTMLTemplateElement === 'undefined') {
		document.write('<script src="https://static.docs.com/ui/third-party/template/1.4.0/template.min.js" integrity="sha384-1zKzI6ldTVHMU7n0W2HpE/lhHI+UG4D9IIaxbj3kT2UhCWicdTuJkTtnKuu0CQzN" crossorigin="anonymous"><\/script>');
	}
	if (typeof URL !== 'function') {
		document.write('<script src="https://static.docs.com/ui/third-party/url/0.5.7/url.min.js" integrity="sha384-vn7xBMtpSTfzaTRWxj0kVq0UcsbBrTOgZ/M1ISHqe1V358elYva+lfiEC+T8jLPc" crossorigin="anonymous"><\/script>');
	}
	</script>

	<script src="https://ajax.aspnetcdn.com/ajax/jQuery/jquery-3.3.1.min.js" integrity="sha384-tsQFqpEReu7ZLhBV2VZlAu7zcOV+rXbYlF2cqB8txI/8aZajjp4Bqd+V6D5IgvKT" crossorigin="anonymous"></script>
		<script src="/_themes/docs.theme/master/en-us/_themes/scripts/ae52c0cf.index-docs.js"></script>

</head>

<body lang="en-us" dir="ltr">
<div class="header-holder has-default-focus">
	<a href="#main" class="skip-to-main-link visually-hidden-until-focused is-fixed has-inner-focus focus-visible has-top-zero has-left-zero has-right-zero has-padding-medium has-text-centered has-body-background-medium" tabindex="1">Skip to main content</a>
		<div id="headerAreaHolder" data-bi-name="header">
			<div id="uhf-placeholder"></div>
		</div>
	<div class="content-header uhf-container has-padding has-default-focus" data-bi-name="content-header">
		<nav class="has-padding-none-mobile" data-bi-name="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList" role="navigation" aria-label="Breadcrumb">
		<ul id="page-breadcrumbs" class="breadcrumbs">
		</ul>
		</nav>
		<div class="content-header-controls">
			<button type="button" class="contents-button button" data-bi-name="contents-expand" aria-haspopup="true">
				<span class="icon"><span class="docon docon-menu" aria-hidden="true"></span></span>
				<span>Contents</span>
			</button>
		</div>
		<div class="content-header-controls exit-focus">
			<button type="button" class="ap-collapse-behavior ap-expanded button" data-bi-name="ap-collapse" aria-controls="action-panel">
				<span class="icon"><span class="docon docon-exit-mode" aria-hidden="true"></span></span>
				<span>Exit focus mode</span>
			</button>
			
		</div>
		<div class="action-bar">
			<ul class="action-list">
							<li id="contenteditbtn" hidden>
									<a href="https://github.com/MicrosoftDocs/win32-pr/blob/live/desktop-src/xinput/xinput-and-directinput.md"  class="button is-text is-icon-only-touch is-small" title="Edit This Document" data-bi-name="edit">
									<span class="icon">
										<span class="docon docon-edit-outline" aria-hidden="true"></span>
									</span>
									<span class="action-item-text is-hidden-portrait">Edit</span>
								</a>
							</li>
				<li>
					<div class="sharing dropdown has-caret" auto-align>
						<button class="dropdown-trigger button is-text is-small is-icon-only-touch" aria-controls="sharing-menu" aria-expanded="false" title="Share This Document" data-bi-name="share">
							<span class="icon" aria-hidden="true">
								<span class="docon docon-sharing"></span>
							</span>
							<span class="action-item-text is-hidden-portrait">Share</span>
						</button>
						<div class="dropdown-menu" id="sharing-menu">
							<ul data-bi-name="share-links">
								<li>
									<a class="share-twitter" data-bi-name="twitter">
										<span class="icon">
											<span class="docon docon-brand-twitter" aria-hidden="true"></span>
										</span>
										<span>Twitter</span>
									</a>
								</li>
								<li>
									<a class="share-linkedin" data-bi-name="linkedin">
										<span class="icon">
											<span class="docon docon-brand-linkedin" aria-hidden="true"></span>
										</span>
										<span>LinkedIn</span>
									</a>
								</li>
								<li>
									<a class="share-facebook" data-bi-name="facebook">
										<span class="icon">
											<span class="docon docon-brand-facebook" aria-hidden="true"></span>
										</span>
										<span>Facebook</span>
									</a>
								</li>
								<li>
									<a class="share-email" data-bi-name="email">
										<span class="icon">
											<span class="docon docon-mail-message-fill" aria-hidden="true"></span>
										</span>
										<span>Email</span>
									</a>
								</li>
							</ul>
						</div>
					</div>
				</li>
				<li class="is-unstyle-action-list-item">
<div class="dropdown has-caret" auto-align>
	<button class="dropdown-trigger button is-text is-small is-icon-only-touch"
		aria-controls="theme-menu" aria-expanded="false" title="Theme" data-bi-name="theme">
		<span class="icon">
			<span class="docon docon-sun" aria-hidden="true"></span>
		</span>
		<span class="action-item-text is-hidden-portrait">Theme</span>
	</button>
	<div class="dropdown-menu" id="theme-menu" role="menu">
		<div class="theme-selector has-padding-small">
			<div class="theme is-block">
				<button class="button is-text is-small theme-control is-fullwidth has-flex-justify-content-start"
					data-theme-to="light" role="menuitem">
					<span class="theme-light has-margin-right-small">
						<span
							class="theme-selector-icon css-variable-support has-border is-inline-block has-body-background"
							aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg"
								viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background" />
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary" />
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary" />
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary" />
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary" />
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary" />
							</svg>
						</span>
					</span>
					<span>
Light					</span>
				</button>
			</div>
			<div class="theme is-block">
				<button class="button is-text is-small theme-control is-fullwidth has-flex-justify-content-start"
					data-theme-to="dark" role="menuitem">
					<span class="theme-dark has-margin-right-small">
						<span
							class="has-border theme-selector-icon css-variable-support is-inline-block has-body-background"
							aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg"
								viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background" />
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary" />
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary" />
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary" />
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary" />
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary" />
							</svg>
						</span>
					</span>
					<span>
Dark					</span>
				</button>
			</div>
			<div class="theme is-block">
				<button class="button is-text is-small theme-control is-fullwidth has-flex-justify-content-start"
					data-theme-to="high-contrast" role="menuitem">
					<span class="theme-high-contrast has-margin-right-small">
						<span
							class="has-border theme-selector-icon css-variable-support is-inline-block has-body-background"
							aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg"
								viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background" />
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary" />
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary" />
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary" />
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary" />
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary" />
							</svg>
						</span>
					</span>
					<span>
High contrast					</span>
				</button>
			</div>
		</div>
	</div>
</div>				</li>
				<li class="is-unstyled-action-list-item">
					<a class="docs-sign-in auth-status-determined not-authenticated button is-text has-text-primary is-small" href="#">Sign in</a>
					<div class="dropdown has-caret auth-status-determined authenticated" auto-align>
						<button class="dropdown-trigger button is-text is-small is-icon-only-touch has-inner-focus" aria-label="Your Account" aria-controls="user-menu" aria-expanded="false">
							<span class="icon" aria-hidden="true">
								<span class="image">
									<img class="has-body-background-medium is-rounded" data-profile-property="avatarUrl">
								</span>
							</span>
							<span class="is-truncated has-margin-left-small" data-profile-property="userName"></span>
						</button>
						<div class="dropdown-menu box" id="user-menu" role="menu">
							<div class="media is-user-dir">
								<div class="media-left">
									<span class="image is-64x64" aria-hidden="true">
										<img class="has-body-background-medium is-rounded" data-profile-property="avatarUrl">
									</span>
								</div>
								<div class="media-content">
									<p class="title">
										<span class="is-truncated" style="max-width: 200px" data-profile-property="userName"></span>
									</p>
									<p class="subtitle has-margin-bottom-none">
										<span class="is-truncated" style="max-width: 200px" data-profile-property="upn"></span>
									</p>
									<ul class="is-unstyled has-margin-none has-margin-top-small">
										<li><a href="/profile" data-profile-property="profileUrl">Profile</a></li>
										<li><a class="docs-sign-out" href="#">Sign out</a></li>
									</ul>
								</div>
							</div>
						</div>
					</div>
				</li>
			</ul>
			<button type="button" class="contents-button" aria-label="Contents" data-bi-name="contents-expand-">
				<span class="docon docon-editor-list-bullet"></span><span>Contents</span>
			</button>
		</div>
	</div>

		<div id="banner-holder" class="has-default-focus has-overflow-hidden">
		</div>

	<div id="disclaimer-holder" class="has-overflow-hidden has-default-focus"></div>
	</div>

	<div class="mainContainer uhf-container  has-top-padding  has-default-focus" data-bi-name="body">

		<div class="columns has-large-gaps ">

			<div id="left-container" class="left-container is-hidden-mobile column is-one-third-tablet is-one-quarter-desktop">
				<nav id="affixed-left-container" class="is-fixed is-flex is-flex-column" role="navigation" aria-label="Primary"></nav>
			</div>

			<section class="primary-holder column is-two-thirds-tablet is-three-quarters-desktop">
				<div class="columns has-large-gaps ">


				<div id="main-column" class="column  is-full is-four-fifths-desktop ">

					<main id="main" role="main" class="content " data-bi-name="content" lang="en-us" dir="ltr">




						<h1 id="xinput-and-directinput" sourcefile="xinput/xinput-and-directinput.md" sourcestartlinenumber="9">XInput and DirectInput</h1>

						<ul class="metadata page-metadata" data-bi-name="page info" lang="en-us" dir="ltr">
							<li class="displayDate loading">
								<time role="presentation" datetime="2018-05-31T00:00:00.000Z" data-article-date-source="ms.date">05/31/2018</time>
							</li>
								<li class="readingTime">4 minutes to read</li>
							<li class="contributors-holder">
								<a class="has-inner-focus" href="https://github.com/MicrosoftDocs/win32-pr/blob/live/desktop-src/xinput/xinput-and-directinput.md" title="2 Contributors" aria-label="2 Contributors">
									<ul class="contributors" data-bi-name="contributors" aria-hidden="true">
												<li><img src="https://docs.microsoft.com/_themes/docs.theme/master/en-us/_themes/images/contributor.svg" data-src="https://github.com/Karl-Bridge-Microsoft.png?size=32" role="presentation"/></li>
												<li><img src="https://docs.microsoft.com/_themes/docs.theme/master/en-us/_themes/images/contributor.svg" data-src="https://github.com/msatranjr.png?size=32" role="presentation"/></li>
									</ul>
								</a>
							</li>

						</ul>


						<nav id="center-doc-outline" class="doc-outline is-hidden-desktop" data-bi-name="intopic toc" role="navigation" aria-label="Article Outline">
							<h3>In this article</h3>
						</nav>


						<!-- <content> -->
							
<p>XInput is an API that allows applications to receive input from the Xbox 360 Controller for Windows. This document describes the differences between XInput and <a href="https://msdn.microsoft.com/en-us/library/Ee416842(v=VS.85).aspx" data-linktype="external">DirectInput</a> implementations of the Xbox 360 Controller and how you can support XInput devices and legacy DirectInput devices at the same time.</p>
<div class="NOTE">
<p>Note</p>
<p>Use of legacy <a href="https://msdn.microsoft.com/en-us/library/Ee416842(v=VS.85).aspx" data-linktype="external">DirectInput</a> is not recommended, and DirectInput is not available for Windows Store apps.</p>
</div>
<p> </p>
<h2 id="the-new-standard-xinput">The New Standard: XInput</h2>
<p>XInput is now available for game development. This is the new input standard for both the Xbox 360 and Windows XP with Service Pack 1 (SP1) and later, and Windows Vista. The APIs are available through the DirectX SDK, and the driver is available through Windows Update.</p>
<p>There are several advantages to using XInput over <a href="https://msdn.microsoft.com/en-us/library/Ee416842(v=VS.85).aspx" data-linktype="external">DirectInput</a>:</p>
<ul>
<li>XInput is easier to use and requires less setup than <a href="https://msdn.microsoft.com/en-us/library/Ee416842(v=VS.85).aspx" data-linktype="external">DirectInput</a></li>
<li>Both Xbox 360 and Windows programming will use the same sets of core APIs, allowing programming to translate cross-platform much easier</li>
<li>There will be a large installed base of Xbox 360 controllers</li>
<li>XInput devices (that is, the Xbox 360 controllers) will have vibration functionality only when using XInput APIs</li>
<li>Future controllers released for the Xbox 360 console (that is, steering wheels) will also work on Windows</li>
</ul>
<h3 id="using-the-xbox-360-controller-with-directinput">Using the Xbox 360 Controller with DirectInput</h3>
<p>The Xbox 360 Controller is properly enumerated on <a href="https://msdn.microsoft.com/en-us/library/Ee416842(v=VS.85).aspx" data-linktype="external">DirectInput</a>, and can be used with the DirectInputAPIs. However, some functionality provided by XInput will be missing from the DirectInput implementation:</p>
<ul>
<li>The left and right trigger buttons will act as a single button, not independently</li>
<li>The vibration effects will not be available</li>
<li>Querying for headset devices will not be available</li>
</ul>
<p>The combination of the left and right triggers in <a href="https://msdn.microsoft.com/en-us/library/Ee416842(v=VS.85).aspx" data-linktype="external">DirectInput</a> is by design. Games have always assumed that DirectInput device axes are centered when there is no user interaction with the device. However, the Xbox 360 controller was designed to register minimum value, not center, when the triggers are not being held. Older games would therefore assume user interaction.</p>
<p>The solution was to combine the triggers, setting one trigger to a positive direction and the other to a negative direction, so no user interaction is indicative to <a href="https://msdn.microsoft.com/en-us/library/Ee416842(v=VS.85).aspx" data-linktype="external">DirectInput</a> of the &quot;control&quot; being at center.</p>
<p>In order to test the trigger values separately, you must use XInput.</p>
<h2 id="xinput-and-directinput-side-by-side">XInput and DirectInput Side by Side</h2>
<p>By supporting XInput only, your game will not work with legacy <a href="https://msdn.microsoft.com/en-us/library/Ee416842(v=VS.85).aspx" data-linktype="external">DirectInput</a> devices. XInput will not recognize these devices.</p>
<p>If you want your game to support legacy <a href="https://msdn.microsoft.com/en-us/library/Ee416842(v=VS.85).aspx" data-linktype="external">DirectInput</a> devices, you may use DirectInput and XInput side by side. When enumerating your DirectInput devices, all DirectInput devices will enumerate correctly. All XInput devices will show up as both XInput and DirectInput devices, but they should not be handled through DirectInput. You will need to determine which of your DirectInput devices are legacy devices, and which are XInput devices, and remove them from the enumeration of DirectInput devices.</p>
<p>To do this, insert this code into your DirectInput enumeration callback:</p>
<pre><code>#include &lt;wbemidl.h&gt;
#include &lt;oleauto.h&gt;
#include &lt;wmsstd.h&gt;

//-----------------------------------------------------------------------------
// Enum each PNP device using WMI and check each device ID to see if it contains 
// &quot;IG_&quot; (ex. &quot;VID_045E&amp;PID_028E&amp;IG_00&quot;).  If it does, then it's an XInput device
// Unfortunately this information can not be found by just using DirectInput 
//-----------------------------------------------------------------------------
BOOL IsXInputDevice( const GUID* pGuidProductFromDirectInput )
{
    IWbemLocator*           pIWbemLocator  = NULL;
    IEnumWbemClassObject*   pEnumDevices   = NULL;
    IWbemClassObject*       pDevices[20]   = {0};
    IWbemServices*          pIWbemServices = NULL;
    BSTR                    bstrNamespace  = NULL;
    BSTR                    bstrDeviceID   = NULL;
    BSTR                    bstrClassName  = NULL;
    DWORD                   uReturned      = 0;
    bool                    bIsXinputDevice= false;
    UINT                    iDevice        = 0;
    VARIANT                 var;
    HRESULT                 hr;

    // CoInit if needed
    hr = CoInitialize(NULL);
    bool bCleanupCOM = SUCCEEDED(hr);

    // Create WMI
    hr = CoCreateInstance( __uuidof(WbemLocator),
                           NULL,
                           CLSCTX_INPROC_SERVER,
                           __uuidof(IWbemLocator),
                           (LPVOID*) &amp;pIWbemLocator);
    if( FAILED(hr) || pIWbemLocator == NULL )
        goto LCleanup;

    bstrNamespace = SysAllocString( L&quot;\\\\.\\root\\cimv2&quot; );if( bstrNamespace == NULL ) goto LCleanup;        
    bstrClassName = SysAllocString( L&quot;Win32_PNPEntity&quot; );   if( bstrClassName == NULL ) goto LCleanup;        
    bstrDeviceID  = SysAllocString( L&quot;DeviceID&quot; );          if( bstrDeviceID == NULL )  goto LCleanup;        
    
    // Connect to WMI 
    hr = pIWbemLocator-&gt;ConnectServer( bstrNamespace, NULL, NULL, 0L, 
                                       0L, NULL, NULL, &amp;pIWbemServices );
    if( FAILED(hr) || pIWbemServices == NULL )
        goto LCleanup;

    // Switch security level to IMPERSONATE. 
    CoSetProxyBlanket( pIWbemServices, RPC_C_AUTHN_WINNT, RPC_C_AUTHZ_NONE, NULL, 
                       RPC_C_AUTHN_LEVEL_CALL, RPC_C_IMP_LEVEL_IMPERSONATE, NULL, EOAC_NONE );                    

    hr = pIWbemServices-&gt;CreateInstanceEnum( bstrClassName, 0, NULL, &amp;pEnumDevices ); 
    if( FAILED(hr) || pEnumDevices == NULL )
        goto LCleanup;

    // Loop over all devices
    for( ;; )
    {
        // Get 20 at a time
        hr = pEnumDevices-&gt;Next( 10000, 20, pDevices, &amp;uReturned );
        if( FAILED(hr) )
            goto LCleanup;
        if( uReturned == 0 )
            break;

        for( iDevice=0; iDevice&lt;uReturned; iDevice++ )
        {
            // For each device, get its device ID
            hr = pDevices[iDevice]-&gt;Get( bstrDeviceID, 0L, &amp;var, NULL, NULL );
            if( SUCCEEDED( hr ) &amp;&amp; var.vt == VT_BSTR &amp;&amp; var.bstrVal != NULL )
            {
                // Check if the device ID contains &quot;IG_&quot;.  If it does, then it's an XInput device
                    // This information can not be found from DirectInput 
                if( wcsstr( var.bstrVal, L&quot;IG_&quot; ) )
                {
                    // If it does, then get the VID/PID from var.bstrVal
                    DWORD dwPid = 0, dwVid = 0;
                    WCHAR* strVid = wcsstr( var.bstrVal, L&quot;VID_&quot; );
                    if( strVid &amp;&amp; swscanf( strVid, L&quot;VID_%4X&quot;, &amp;dwVid ) != 1 )
                        dwVid = 0;
                    WCHAR* strPid = wcsstr( var.bstrVal, L&quot;PID_&quot; );
                    if( strPid &amp;&amp; swscanf( strPid, L&quot;PID_%4X&quot;, &amp;dwPid ) != 1 )
                        dwPid = 0;

                    // Compare the VID/PID to the DInput device
                    DWORD dwVidPid = MAKELONG( dwVid, dwPid );
                    if( dwVidPid == pGuidProductFromDirectInput-&gt;Data1 )
                    {
                        bIsXinputDevice = true;
                        goto LCleanup;
                    }
                }
            }   
            SAFE_RELEASE( pDevices[iDevice] );
        }
    }

LCleanup:
    if(bstrNamespace)
        SysFreeString(bstrNamespace);
    if(bstrDeviceID)
        SysFreeString(bstrDeviceID);
    if(bstrClassName)
        SysFreeString(bstrClassName);
    for( iDevice=0; iDevice&lt;20; iDevice++ )
        SAFE_RELEASE( pDevices[iDevice] );
    SAFE_RELEASE( pEnumDevices );
    SAFE_RELEASE( pIWbemLocator );
    SAFE_RELEASE( pIWbemServices );

    if( bCleanupCOM )
        CoUninitialize();

    return bIsXinputDevice;
}


//-----------------------------------------------------------------------------
// Name: EnumJoysticksCallback()
// Desc: Called once for each enumerated joystick. If we find one, create a
//       device interface on it so we can play with it.
//-----------------------------------------------------------------------------
BOOL CALLBACK EnumJoysticksCallback( const DIDEVICEINSTANCE* pdidInstance,
                                     VOID* pContext )
{
    HRESULT hr;

    if( IsXInputDevice( &amp;pdidInstance-&gt;guidProduct ) )
        return DIENUM_CONTINUE;

     // Device is verified not XInput, so add it to the list of DInput devices

     return DIENUM_CONTINUE;    
}
</code></pre>
<h2 id="related-topics">Related topics</h2>
<dl> <dt>
<p><a href="getting-started-with-xinput" data-linktype="relative-path">Getting Started With XInput</a></p>
</dt> <dt>
<p><a href="programming-reference" data-linktype="relative-path">Programming Reference</a></p>
</dt> </dl>
<p> </p>
<p> </p>

						<!-- </content> -->

						</main>

						<!-- feedback section -->





						<!-- end feedback section -->

						<div class="footerContainer is-visible-interactive has-default-focus ">
<footer id="footer-interactive" data-bi-name="footer" class="footer-layout">

    <a data-mscc-ic="false" class="locale-selector-link" href="#" data-bi-name="select-locale"><span class="icon docon docon-world is-size-4 has-margin-right-small" aria-hidden="true"></span><span class="local-selector-link-text"></span></a>

    <ul class="links" data-bi-name="footerlinks">
		<li><a data-mscc-ic="false" href="https://docs.microsoft.com/previous-versions/" data-bi-name="archivelink">Previous Version Docs</a></li>
		<li><a data-mscc-ic="false" href="https://docs.microsoft.com/teamblog" data-bi-name="bloglink">Blog</a></li>
		<li><a data-mscc-ic="false" href="https://docs.microsoft.com/contribute" data-bi-name="contributorGuide">Contribute</a></li>
			<li><a data-mscc-ic="false" href="https://go.microsoft.com/fwlink/?LinkId=521839" data-bi-name="privacy">Privacy &amp; Cookies</a></li>
		<li><a data-mscc-ic="false" href="/en-us/legal/termsofuse" data-bi-name="termsofuse">Terms of Use</a></li>
		<li><a data-mscc-ic="false" href="https://aka.ms/sitefeedback" data-bi-name="feedback">Site Feedback</a></li>
		<li><a data-mscc-ic="false" href="https://www.microsoft.com/en-us/legal/intellectualproperty/Trademarks/EN-US.aspx" data-bi-name="trademarks">Trademarks</a></li>
    </ul>
</footer>
						</div>
					</div>

					<div id="page-actions" class="right-container column is-one-quarter is-one-fifth-desktop is-hidden-mobile is-hidden-tablet-only" data-bi-name="pageactions" role="complementary" aria-label="Page Actions">
							<nav id="side-doc-outline" class="doc-outline is-fixed is-vertically-scrollable" data-bi-name="intopic toc" role="navigation" aria-label="Article Outline">
								<h3>In this article</h3>
							</nav>
					</div>

					<!--end of div.columns -->
				</div>

			<!--end of .primary-holder -->
			</section>

			<aside id="interactive-container" class="interactive-container is-visible-interactive column has-body-background-dark ">
			</aside>
		</div>

		<!--end of .mainContainer -->
	</div>

	<div id="openFeedbackContainer" class="openfeedback-container"></div>

	<div class="footerContainer has-default-focus is-hidden-interactive ">
<footer id="footer" data-bi-name="footer" class="footer-layout uhf-container has-padding" role="contentinfo">

    <a data-mscc-ic="false" class="locale-selector-link" href="#" data-bi-name="select-locale"><span class="icon docon docon-world is-size-4 has-margin-right-small" aria-hidden="true"></span><span class="local-selector-link-text"></span></a>

    <ul class="links" data-bi-name="footerlinks">
		<li><a data-mscc-ic="false" href="https://docs.microsoft.com/previous-versions/" data-bi-name="archivelink">Previous Version Docs</a></li>
		<li><a data-mscc-ic="false" href="https://docs.microsoft.com/teamblog" data-bi-name="bloglink">Blog</a></li>
		<li><a data-mscc-ic="false" href="https://docs.microsoft.com/contribute" data-bi-name="contributorGuide">Contribute</a></li>
			<li><a data-mscc-ic="false" href="https://go.microsoft.com/fwlink/?LinkId=521839" data-bi-name="privacy">Privacy &amp; Cookies</a></li>
		<li><a data-mscc-ic="false" href="/en-us/legal/termsofuse" data-bi-name="termsofuse">Terms of Use</a></li>
		<li><a data-mscc-ic="false" href="https://aka.ms/sitefeedback" data-bi-name="feedback">Site Feedback</a></li>
		<li><a data-mscc-ic="false" href="https://www.microsoft.com/en-us/legal/intellectualproperty/Trademarks/EN-US.aspx" data-bi-name="trademarks">Trademarks</a></li>
    </ul>
</footer>
	</div>

	<div id="action-panel" role="region" aria-label="Action Panel" class="action-panel has-default-focus" tabindex="-1"></div>
</body>
</html>
